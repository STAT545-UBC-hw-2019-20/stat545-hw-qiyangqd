---
title: "hw_03"
author: "Qi Yang"
date: "2019/9/30"
output: 
        html_document:
        toc: TRUE
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r load, echo = FALSE, warning = FALSE, message = FALSE}
options(scipen = 999) # Force R not to use scientific notation
library(tidyverse)
library(gapminder)
library(DT)
```

## Task 1: 
### Task Option 2: Get the maximum and minimum of GDP per capita for all continents.
1. Tibble  
```{r, warning = FALSE}
gapminder %>% 
  group_by(continent) %>% 
  filter(gdpPercap == max(gdpPercap)) %>% 
  summarize(max = max(gdpPercap),
            country_max = country[gdpPercap == max],
            year_max = year[gdpPercap == max],
            min = min(gdpPercap),
            country_min= country[gdpPercap == min],
            year_min = year[gdpPercap == min],) %>% 
DT::datatable()
```

This tibble shows the maximum and minimum GDP per capita, corresponding countries and years in each continent. We can see Europe had the maximum GDP per capita of the whole world in 2007, when Norway reached 49357.19017. Africa had the minimum GDP per capita across the globe in 2002, when Congo, Dem. Rep. achieved only 241.1658765. 

2. Plot
This plot shows...
```{r}
gapminder %>% 
  group_by(continent) %>% 
  filter(gdpPercap == max(gdpPercap) | gdpPercap == min(gdpPercap)) %>% 
  select(continent, country, gdpPercap, year) %>% 
  arrange(continent, gdpPercap) %>% 
#???how do I add a column specifying max or min, in order to plot?
DT::datatable()
```

```{r}
# trying
continent_lifeExp <- gapminder %>% 
         group_by(continent) %>% 
         summarize(max = max(gdpPercap),
                   min = min(gdpPercap))
# trying
# continent_lifeExp %>%   
#  ggplot(aes(continent, gdpPercap)) +
#  geom_bar(stat = "identity", position = "dodge")
```

## Task 2:
### Task Option 3: Look at the spread of GDP per capita within the continents.
1. Spread should include *range*, *quartiles*, *interquartile range*, *variance* and *standard deviation*. This tibble shows...
```{r}
gapminder %>% 
  group_by(continent) %>%
  summarize(range = paste(min(gdpPercap), max(gdpPercap), sep = " ~ "),
            Q1 = quantile(gdpPercap,0.25),
            Q2 = quantile(gdpPercap,0.5),
            Q3 = quantile(gdpPercap,0.75),
            IQR = IQR(gdpPercap),
            VAR = var(gdpPercap),
            SD = sd(gdpPercap)) %>% 
  DT::datatable()
```
2. Plot  
This plot shows...
```{r}
ggplot(gapminder, aes(gdpPercap, color = continent)) +
  geom_line(stat = "density") +
  scale_x_log10(labels = scales::comma_format()) # how to make the scale of y-axis the same?

```
## Task 3:
### Task Option 5: How is life expectancy changing over time on different continents?
1. The tibble shows...
```{r}
gapminder %>% 
  group_by(continent,year) %>% 
  summarize(min = min(lifeExp),
            mean = mean(lifeExp),
            max = max(lifeExp)) %>% 
  DT::datatable()
  
```
2. The plot shows...
```{r}
gapminder %>% 
  group_by(continent, year) %>% 
  summarize(min = min(lifeExp),
            mean = mean(lifeExp),
            max = max(lifeExp)) %>% 
  ggplot(aes(year, mean, colour = continent)) +
  geom_line()+
  geom_point()
```


