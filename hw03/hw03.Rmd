---
title: "hw_03"
author: "Qi Yang"
date: "2019/9/30"
output: 
        html_document:
        toc: TRUE
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r load, echo = FALSE, warning = FALSE, message = FALSE}
options(scipen = 999) # Force R not to use scientific notation
library(tidyverse)
library(tidyr)
library(gapminder)
library(DT)
```

## Task 1: 
### Task Option 2: Get the maximum and minimum of GDP per capita for all continents.
1. Tibble  
```{r, warning = FALSE}
gapminder %>% 
  group_by(continent) %>% 
  summarize(max = max(gdpPercap),
            country_max = country[gdpPercap == max],
            year_max = year[gdpPercap == max],
            min = min(gdpPercap),
            country_min= country[gdpPercap == min],
            year_min = year[gdpPercap == min],) %>% 
DT::datatable()
```

This tibble shows the maximum and minimum GDP per capita, corresponding countries and years in each continent. We can see Europe had the maximum GDP per capita of the whole world in 2007, when Norway reached 49357.19017. Africa had the minimum GDP per capita across the globe in 2002, when Congo, Dem. Rep. achieved only 241.1658765. 

2. Plot       

```{r}
gapminder %>% 
  group_by(continent) %>% 
  summarize(Max = max(gdpPercap),
            Min = min(gdpPercap),
            Max_forPlot = max(gdpPercap)) %>% # create a column for reordering bars in the plot below
  pivot_longer(cols      = c(Max, Min),
               names_to  = "Max_or_Min",
               values_to = "gdpPercap") %>% 
  ggplot(aes(x= reorder(continent, Max_forPlot), gdpPercap)) +
    geom_bar(stat = "identity", aes(fill = Max_or_Min), position = "dodge")+
     scale_y_log10("GDP per capita", labels = scales::dollar_format())+
     scale_x_discrete("Continent") +
     theme_light()+
     scale_fill_brewer(palette = "Paired", name = "GDP per capita")
```  

This plot shows the maximum and minimum GDP per capita of each continent. We can easily see that the order of continents with GDP per capita from low to high is: Africa, Oceania, Americas, Europe, Asia. It is also interesting to see that Oceania tends to have the samllest gap between the highest and the lowest GDP per capita, while Asia has the biggest gap.


## Task 2:
### Task Option 3: Look at the spread of GDP per capita within the continents.
1. Spread should include *range*, *quartiles*, *interquartile range*, *variance* and *standard deviation*. This tibble shows...
```{r}
gapminder %>% 
  group_by(continent) %>%
  summarize(range = paste(min(gdpPercap), max(gdpPercap), sep = " ~ "),
            Q1 = quantile(gdpPercap,0.25),
            Q2 = quantile(gdpPercap,0.5),
            Q3 = quantile(gdpPercap,0.75),
            IQR = IQR(gdpPercap),
            VAR = var(gdpPercap),
            SD = sd(gdpPercap)) %>% 
  DT::datatable()
```
2. Plot  
This plot shows...
```{r}
ggplot(gapminder, aes(gdpPercap, color = continent)) +
  geom_line(stat = "density") +
  scale_x_log10(labels = scales::comma_format()) # how to make the scale of y-axis the same?

```
## Task 3:
### Task Option 5: How is life expectancy changing over time on different continents?
1. The tibble shows...
```{r}
gapminder %>% 
  group_by(continent,year) %>% 
  summarize(min = min(lifeExp),
            mean = mean(lifeExp),
            max = max(lifeExp)) %>% 
  DT::datatable()
  
```
2. The plot shows...
```{r}
gapminder %>% 
  group_by(continent, year) %>% 
  summarize(min = min(lifeExp),
            mean = mean(lifeExp),
            max = max(lifeExp)) %>% 
  ggplot(aes(year, mean, colour = continent)) +
  geom_line()+
  geom_point()
```


