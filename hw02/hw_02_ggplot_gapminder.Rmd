---
title: "hw_02_ggplot_gapminder"
author: "Qi Yang"
date: "2019/9/23"
output: 
        github_document:
        keep_md: true
        toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r load, echo = FALSE, warning = FALSE, message = FALSE}
library(tidyverse)
library(gapminder)
```

## Exercise 1
### 1.1 Subseting gapminder to three countries in the 1970’s with `filter()`.
```{r, warning = FALSE}
gapminder %>%
  filter(year > 1969 & year < 1980,
         country == "Italy" | country == "Australia" | country == "Mexico")
```
### 1.2 Selecting “country” and “gdpPercap” from 1.1 with ` %>% `.
```{r, warning = FALSE}
gapminder %>%
  filter(year > 1969 & year < 1980,
         country == "Italy" | country == "Australia" | country == "Mexico") %>% 
  select(country, gdpPercap)
```
### 1.3 Adding variable `lifeExpInc` to show filtered entries that have experienced drops in life expectancy with `lag()`.
```{r, warning = FALSE}
gapminder %>% 
  mutate(lifeExpInc = lifeExp-lag(gapminder$lifeExp,1)) %>% 
  filter(lifeExpInc < 0, year != 1952) %>% 
  select(lifeExpInc, everything()) %>% 
  arrange(lifeExpInc)
```
### 1.4 Adding `gdpPercapMax` to show the max GDP per capita experienced by each country with `max()`.
```{r, warning = FALSE}
gapminder %>% 
  group_by(country) %>% 
  filter(gdpPercap == max(gdpPercap)) %>% 
  rename(gdpPercapMax = gdpPercap) %>% 
  select(gdpPercapMax, country) %>% 
  arrange(desc(gdpPercapMax))
```
### 1.5 Scatter plot: Canada’s life expectancy vs. GDP per capita
```{r, echo = FALSE, warning = FALSE}
gapminder %>% 
  filter(country == "Canada") %>% {
  ggplot(.) +
  geom_point(aes(gdpPercap, lifeExp)) +
  scale_y_continuous("Life expectancy (year)") +
  scale_x_log10("GDP per capital",
                labels = scales::dollar_format())
  }
```

## Exercise 2

## Exercise 3
### 3.1 Scatterplot: Life expectancy vs. population in Africa and Europe
```{r, warning = FALSE, echo = FALSE, message = FALSE}
ggplot(subset(gapminder,continent %in% c("Africa" , "Europe")),
       aes(pop/1000000, lifeExp, color=continent)) + 
  geom_point() +
  geom_smooth(se=FALSE, fullrange=TRUE) +
  scale_x_log10("Population (million)") +
  scale_y_continuous("Life expectancy (years)") +
  theme_classic() +
  scale_color_brewer(palette="Paired", name = "Continent")
```  

### 3.2 Bar plot: GDP per capita vs. year in each continent
```{r, warning = FALSE, echo = FALSE}
ggplot(gapminder, aes(year, gdpPercap/1000)) +
  geom_bar(stat = "identity", 
           aes(fill = continent), 
           position = "dodge") + 
  scale_x_continuous("Year") +
  scale_y_continuous("GDP per capita (thousand)", 
                     labels = scales::dollar_format(), 
                     expand=c(0,0)) +
  theme_classic() + 
  scale_fill_brewer(palette = "Set3", name = "Continent")
```

